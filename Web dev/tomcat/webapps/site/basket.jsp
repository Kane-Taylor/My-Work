<%@ page import="java.util.Map" %><%@ page import="shop.Product" %><jsp:useBean id='basket'         scope='session'         class='shop.Basket'          /><%    String empty = request.getParameter("emptyBasket");    if (empty!=null) {        basket.clearBasket();        response.sendRedirect(request.getContextPath() + "/basket.jsp");        return;    }    String item = request.getParameter("addItem");    if(null != item){       basket.addItem(item);       // Post-Redirect-Get (PRG) pattern.       response.sendRedirect(request.getContextPath() + "/basket.jsp");       return;    }    item = request.getParameter("subItem");    if(null != item){        basket.subItem(item);        response.sendRedirect(request.getContextPath() + "/basket.jsp");        return;    }%><html><head>    <title>My Shop</title>    <link href="krt.css" rel="stylesheet" type="text/css"></head><body><jsp:include page="krtheader.jsp" /><table>    <tr>        <th> </th> <th align="left"> item </th> <th align="right"> quantity </th> <th align="right"> price </th><th> total </th>    </tr>    <%        for (Map.Entry<Product,Integer> entry : basket.getItems( )) {            Product product=entry.getKey();            int quantity=entry.getValue().intValue();    %>    <tr>        <td > <img src="<%= product.thumbnail %>"/> </td>        <td width="200px"> <%= product.title %> </td>        <td width="100px" align="right"> <%= quantity %> &nbsp; <a href = '<%="basket.jsp?addItem="+product.PID%>'>+</a> &nbsp; <a href = '<%="basket.jsp?subItem="+product.PID%>'>-</a></td>        <td width="100px" align="right"> <%= Product.formatPrice(product.price) %> </td>        <td width="100px" align="right"> <%= Product.formatPrice(product.price*quantity) %> </td>    </tr>    <%        }    %></table><p> Order total = <%= basket.getTotalString() %><%    if ( basket.getTotal() > 0) {        %>        <form action="order.jsp" method="post" onsubmit="return checkName(this);">        <input type="text" name="name" size="20">        <input type="submit" value="Place Order" />        </form>        <form action="basket.jsp" method="get">        <input type="hidden" name="emptyBasket" value="yes">        <input type="submit" value="Empty Basket" />        </form>        <%    }%></body><script>    function checkName(form)    {        if(form.name.value == "")        {            alert("Please enter your name!");            form.name.focus();            return false;        }        return true;    }</script></html>